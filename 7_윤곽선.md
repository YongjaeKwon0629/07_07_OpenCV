# 7. ìœ¤ê³½ì„  ì¶”ì¶œê³¼ ë„í˜• ê²€ì¶œ

ìœ¤ê³½ì„ (contour)ì€ ì´ë¯¸ì§€ì—ì„œ **ë™ì¼í•œ ìƒ‰ ë˜ëŠ” ë°ê¸°ë¥¼ ê°€ì§„ í”½ì…€ì˜ ê²½ê³„ì„ **ì„ ì˜ë¯¸í•©ë‹ˆë‹¤. OpenCVì˜ ìœ¤ê³½ì„  ê²€ì¶œ ê¸°ëŠ¥ì€ ê°ì²´ ê°ì§€, ëª¨ì–‘ ë¶„ì„, ì™¸ê³½ì„  ê¸°ë°˜ íŠ¹ì§• ì¶”ì¶œ, ì¶”ì  ë“±ì—ì„œ ë§¤ìš° ìœ ìš©í•˜ê²Œ í™œìš©ë©ë‹ˆë‹¤. íŠ¹íˆ ì‚¬ê°í˜•, ì›, ì‚¼ê°í˜• ë“±ì˜ ë„í˜•ì„ ìë™ìœ¼ë¡œ ì¸ì‹í•˜ê±°ë‚˜, ê°ì²´ì˜ ë©´ì Â·ì¤‘ì‹¬ì Â·í˜•íƒœ ë“±ì„ ë¶„ì„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

## ğŸ” 1. ìœ¤ê³½ì„  ê²€ì¶œ ê¸°ë³¸ íë¦„

ìœ¤ê³½ì„ ì„ ê²€ì¶œí•˜ë ¤ë©´ ë¨¼ì € **Grayscale ë³€í™˜**ê³¼ **ì´ì§„í™”(Thresholding)** ë¥¼ ê±°ì³ì•¼ í•©ë‹ˆë‹¤. ì—£ì§€ ê²€ì¶œ(Canny ë“±) ê²°ê³¼ë„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.

```
import cv2

# 1. ì´ë¯¸ì§€ ë¡œë“œ
img = cv2.imread('shapes.png')

# 2. Grayscale ë³€í™˜
gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

# 3. ì´ì§„í™” ì²˜ë¦¬ (Threshold)
ret, thresh = cv2.threshold(gray, 127, 255, cv2.THRESH_BINARY)

# 4. ìœ¤ê³½ì„  ê²€ì¶œ
contours, hierarchy = cv2.findContours(
    image=thresh,
    mode=cv2.RETR_EXTERNAL,
    method=cv2.CHAIN_APPROX_SIMPLE
)
```

### ğŸ“Œ ì£¼ìš” íŒŒë¼ë¯¸í„° ì„¤ëª…
| íŒŒë¼ë¯¸í„° | ì„¤ëª… |
|----------|------|
| `RETR_EXTERNAL` | ê°€ì¥ ë°”ê¹¥ ìœ¤ê³½ì„ ë§Œ ì¶”ì¶œ (ë‚´ë¶€ ë¬´ì‹œ) |
| `RETR_TREE` | ê³„ì¸µ êµ¬ì¡°ê¹Œì§€ ì €ì¥ (ë¶€ëª¨-ìì‹ ê´€ê³„) |
| `CHAIN_APPROX_SIMPLE` | ê¼­ì§€ì ë§Œ ì €ì¥ (ë©”ëª¨ë¦¬ ì ˆì•½) |
| `CHAIN_APPROX_NONE` | ëª¨ë“  ê²½ê³„ì  ì €ì¥ (ì •ë°€í•˜ì§€ë§Œ ë¬´ê±°ì›€) |

---

## âœï¸ 2. ìœ¤ê³½ì„  ê·¸ë¦¬ê¸° ë° ì‹œê°í™”

ìœ¤ê³½ì„ ì„ ì°¾ì•˜ë‹¤ë©´ `drawContours`ë¡œ ì´ë¯¸ì§€ ìœ„ì— ì‹œê°í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```
cv2.drawContours(img, contours, -1, (0, 255, 0), 2)  # ì „ì²´ ìœ¤ê³½ì„ 
cv2.imshow('Contours', img)
cv2.waitKey(0)
cv2.destroyAllWindows()
```

- `-1`: ëª¨ë“  ìœ¤ê³½ì„ ì„ ê·¸ë¦¬ê² ë‹¤ëŠ” ì˜ë¯¸
- ìƒ‰ìƒ `(0, 255, 0)`ì€ ì´ˆë¡ìƒ‰ (BGR ìˆœ)
- ë‘ê»˜ëŠ” `2`í”½ì…€

> ë‹¨ì¼ ìœ¤ê³½ì„ ë§Œ ê·¸ë¦´ ê²½ìš°: `cv2.drawContours(img, [contours[i]], 0, ...)`

---

## ğŸ“ 3. ë„í˜• ì •ë³´ ì¶”ì¶œ: ë©´ì , ë‘˜ë ˆ, ê·¼ì‚¬í™”

### â–¶ï¸ ë©´ì  & ë‘˜ë ˆ ê³„ì‚°
```
for cnt in contours:
    area = cv2.contourArea(cnt)
    perimeter = cv2.arcLength(cnt, True)
```
- `cv2.contourArea`: ìœ¤ê³½ì„  ë‚´ í”½ì…€ ìˆ˜
- `cv2.arcLength`: ë‘˜ë ˆ ê¸¸ì´ (ê³¡ì„  ì—¬ë¶€ True/False)

### â–¶ï¸ ë„í˜• ê·¼ì‚¬í™” (ê¼­ì§“ì  ë‹¨ìˆœí™”)
```
epsilon = 0.02 * perimeter
approx = cv2.approxPolyDP(cnt, epsilon, True)
```
- ê¼­ì§“ì  ìˆ˜ ê°ì†Œë¡œ **ëª¨ì–‘ ë‹¨ìˆœí™”**
- `approx`ì˜ ê¸¸ì´ë¥¼ í†µí•´ ì‚¼ê°í˜•, ì‚¬ê°í˜• ë“± **ë„í˜• ë¶„ë¥˜** ê°€ëŠ¥

---

## ğŸ“ 4. ë„í˜• ë¶„ë¥˜ ì˜ˆì‹œ (ê¸°í•˜í•™ì  í˜•íƒœ ì¸ì‹)

```
if len(approx) == 3:
    shape = "Triangle"
elif len(approx) == 4:
    x, y, w, h = cv2.boundingRect(approx)
    aspect_ratio = float(w)/h
    if 0.95 < aspect_ratio < 1.05:
        shape = "Square"
    else:
        shape = "Rectangle"
elif len(approx) > 4:
    shape = "Circle or Polygon"
```
- `boundingRect`ë¥¼ í™œìš©í•˜ë©´ **ì‚¬ê°í˜•ê³¼ ì •ì‚¬ê°í˜• êµ¬ë¶„ ê°€ëŠ¥**
- ê¼­ì§“ì  ìˆ˜ê°€ ë§ìœ¼ë©´ ì›í˜•ì´ë‚˜ ë³µí•© ë‹¤ê°í˜•ìœ¼ë¡œ ë¶„ë¥˜

---

## ğŸ“¦ 5. ìœ¤ê³½ì„  ê¸°ë°˜ ì¶”ê°€ ì •ë³´ ì¶”ì¶œ

### ğŸ”¹ ì¤‘ì‹¬ì (Centroid, ë¬´ê²Œì¤‘ì‹¬)
```
M = cv2.moments(cnt)
cx = int(M['m10']/M['m00'])
cy = int(M['m01']/M['m00'])
```
- **ëª¨ë©˜íŠ¸(Moments)**ëŠ” ìœ¤ê³½ì„ ì˜ ì§ˆëŸ‰ ì¤‘ì‹¬, íšŒì „ ì¤‘ì‹¬ ë“±ì„ ê³„ì‚°
- `cx`, `cy`ëŠ” ì¤‘ì‹¬ ì¢Œí‘œ (ì •ìˆ˜í˜• ë³€í™˜ í•„ìš”)

### ğŸ”¹ ê²½ê³„ ì‚¬ê°í˜•(Bounding Rectangle)
```python
x, y, w, h = cv2.boundingRect(cnt)
cv2.rectangle(img, (x, y), (x + w, y + h), (255, 0, 0), 2)
```
- ìµœì†Œ í¬ê¸°ì˜ ì™¸ì ‘ ì‚¬ê°í˜• ê·¸ë¦¬ê¸°

### ğŸ”¹ ìµœì†Œ ì™¸ì ‘ ì›, íƒ€ì›
```python
(x, y), radius = cv2.minEnclosingCircle(cnt)
ellipse = cv2.fitEllipse(cnt)
```
- ì›í˜• ê°ì²´ ê°ì§€ì— íš¨ê³¼ì 
- `fitEllipse`ëŠ” íƒ€ì› í˜•íƒœì— ì í•© (í•„ìˆ˜ ì¡°ê±´: 5ê°œ ì´ìƒì˜ ì )

---

## ğŸ§  ì‹¤ì „ íŒ

- **ì—£ì§€ ê²€ì¶œ â†’ ìœ¤ê³½ì„  ì¶”ì¶œ** ì¡°í•©ì„ ìì£¼ ì‚¬ìš©í•©ë‹ˆë‹¤:
```python
edges = cv2.Canny(gray, 50, 150)
contours, _ = cv2.findContours(edges, cv2.RETR_EXTERNAL, cv2.CHAIN_APPROX_SIMPLE)
```
- **ì‘ì€ ìœ¤ê³½ì„  ì œê±°**:
```python
for cnt in contours:
    if cv2.contourArea(cnt) > 100:
        # ì‹¤ì œ ê°ì²´ë¡œ ê°„ì£¼í•˜ê³  ì²˜ë¦¬
```
- ìœ¤ê³½ì„ ì˜ `ê³„ì¸µ êµ¬ì¡°(hierarchy)`ë¥¼ ë¶„ì„í•˜ì—¬ ì¤‘ì²© êµ¬ì¡° íŒŒì•… ê°€ëŠ¥ (ì˜ˆ: ì‚¬ê°í˜• ì•ˆ ì›)

---

## âœ… ìš”ì•½ í‘œ
| í•­ëª© | í•¨ìˆ˜ | ì„¤ëª… |
|------|------|------|
| ìœ¤ê³½ì„  ê²€ì¶œ | `findContours()` | ê²½ê³„ íƒìƒ‰ (Grayscale+Binary í•„ìš”) |
| ìœ¤ê³½ì„  ê·¸ë¦¬ê¸° | `drawContours()` | ìœ¤ê³½ì„  ì‹œê°í™” |
| ë©´ì /ë‘˜ë ˆ | `contourArea`, `arcLength` | ë„í˜• í¬ê¸° ë° ê¸¸ì´ ì¸¡ì • |
| ë„í˜• ë¶„ë¥˜ | `approxPolyDP()` | ê¼­ì§“ì  ìˆ˜ ê¸°ë°˜ ë‹¨ìˆœí™” |
| ì¤‘ì‹¬ì  | `moments()` | ë¬´ê²Œì¤‘ì‹¬ ê³„ì‚° |
| ì™¸ì ‘ ë„í˜• | `boundingRect`, `minEnclosingCircle`, `fitEllipse` | ì™¸ê³½ ë°•ìŠ¤, ì›, íƒ€ì› ì¶”ì¶œ |

---

> ë‹¤ìŒ: [8. ìƒ‰ìƒ ê³µê°„ê³¼ ë§ˆìŠ¤í‚¹ ì²˜ë¦¬](8_ìƒ‰ìƒê³µê°„.md)
